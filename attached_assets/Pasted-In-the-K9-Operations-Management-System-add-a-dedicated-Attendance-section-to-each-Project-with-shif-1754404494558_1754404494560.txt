In the K9 Operations Management System, add a dedicated Attendance section to each Project with shift setup, absence reasons, and extra usability features.

1. Shift Setup:

Create a ProjectShift table:

id (UUID)

project_id (FK to Projects)

name (Morning, Evening, Night — or custom string)

start_time, end_time (time fields)

Create a ProjectShiftAssignment table:

id (UUID)

shift_id (FK to ProjectShift)

entity_type (enum: Employee, Dog)

entity_id (FK to Employees or Dogs)

Only entities assigned to a project can be added to a shift.

2. Attendance Tracking:

Create a ProjectAttendance table:

id (UUID)

project_id (FK to Projects)

shift_id (FK to ProjectShift)

date (date)

entity_type (enum: Employee, Dog)

entity_id (FK to Employees or Dogs)

status (enum: Present, Absent, Late)

absence_reason (enum: Annual, Sick, Emergency, Other — nullable, only used if status=Absent)

late_reason (nullable text — only used if status=Late)

notes (optional text)

Prevent attendance records for entities not assigned to the project.

3. UI/Frontend:

In the Project detail page, add an Attendance tab.

At the top: date picker + shift selector.

Add search/filter bar to quickly find employees or dogs in large rosters by name, role, or ID.

Table listing all assigned employees and dogs for that shift with:

Status dropdown (Present, Absent, Late).

If Absent → show secondary dropdown for reason (سنوية، مرضية، طارئة، أخرى).

If "Other" absence → show a small notes field.

If Late → show a small optional text field for late reason.

Bulk action buttons: Mark All Present, Mark All Absent (requires reason), Mark All Late (optional reason).

4. Backend Logic:

Routes to create, edit, and view attendance records for a project/shift/date.

Validation:

Only GENERAL_ADMIN or that project’s PROJECT_MANAGER can modify attendance.

Ensure absence_reason is provided when status=Absent.

Ensure late_reason is optional but only stored if status=Late.

Attendance list must pull only from the shift’s assigned employees/dogs.

5. Reporting:

Ability to export attendance for a date range per project to PDF.

Include absence reasons and late reasons in the export.

6. Testing:

Confirm attendance saves correctly.

Confirm reason selection works only for Absent or Late status.

Confirm shifts work and only assigned entities appear in attendance.

Confirm search/filter in attendance tab works with large rosters.